FROM node:18-alpine

WORKDIR /app

# COPY uses the actual file names as they will exist after your rename
COPY backend/package.json ./
RUN npm install --legacy-peer-deps

COPY backend/src ./src
COPY backend/tsconfig.json ./
# User will rename backend/init_sql.txt to backend/init.sql
COPY backend/init.sql ./

RUN npm run build

EXPOSE 4000
CMD ["npm", "start"]